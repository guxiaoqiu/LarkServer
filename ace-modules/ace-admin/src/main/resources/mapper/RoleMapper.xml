<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.github.hollykunge.security.admin.mapper.RoleMapper">
  <resultMap id="BaseResultMap" type="com.github.hollykunge.security.admin.entity.Role">
    <id column="ID" property="id" jdbcType="VARCHAR" />
    <result column="CODE" property="code" jdbcType="VARCHAR" />
    <result column="NAME" property="name" jdbcType="VARCHAR" />
    <result column="PARENT_ID" property="parentId" jdbcType="VARCHAR" />
    <result column="PATH" property="path" jdbcType="VARCHAR" />
    <result column="TYPE" property="type" jdbcType="VARCHAR" />
    <result column="GROUP_TYPE" property="groupType" jdbcType="VARCHAR" />
    <result column="DESCRIPTION" property="description" jdbcType="VARCHAR" />
    <result column="ORG_ID" property="birthDate" jdbcType="VARCHAR" />
    <result column="ORG_NAME" property="gender" jdbcType="VARCHAR" />
    <result column="CRT_TIME" property="crtTime" jdbcType="TIMESTAMP" />
    <result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
    <result column="CRT_NAME" property="crtName" jdbcType="VARCHAR" />
    <result column="CRT_HOST" property="crtHost" jdbcType="VARCHAR" />
    <result column="UPD_TIME" property="updTime" jdbcType="TIMESTAMP" />
    <result column="UPD_USER" property="updUser" jdbcType="VARCHAR" />
    <result column="UPD_NAME" property="updName" jdbcType="VARCHAR" />
    <result column="UPD_HOST" property="updHost" jdbcType="VARCHAR" />
    <result column="ATTR1" property="attr1" jdbcType="VARCHAR" />
    <result column="ATTR2" property="attr2" jdbcType="VARCHAR" />
    <result column="ATTR3" property="attr3" jdbcType="VARCHAR" />
    <result column="ATTR4" property="attr4" jdbcType="VARCHAR" />
  </resultMap>
    <!-- 获取系统所有的角色 -->
  <select id="getAllSystemRole" resultType="com.github.hollykunge.security.admin.entity.Role">
        SELECT
        r. ID ID,
        r. NAME NAME,
        r.DESCRIPTION describe,
        r.CRT_USER creatorId,
        r.CRT_TIME createTime,
        0 deleted,
        1 status
    FROM
        admin_role r
  </select>
    <!-- 根据角色id获取角色所拥有的菜单权限 -->
    <select id="getSystemRoleMenu" resultType="com.github.hollykunge.security.admin.entity.Menu" parameterType="java.lang.String">
        SELECT
          RESOUR.ROLE_ID roleId,
          menu.id permissionId,
          menu.TITLE permissionName
        FROM
            ADMIN_ROLE ROLE
        LEFT JOIN ADMIN_RESOURCEROLEMAP resour ON ROLE . ID = RESOUR.ROLE_ID
        LEFT JOIN ADMIN_MENU menu ON resour.RESOURCE_ID = menu. ID
        WHERE ROLE.id = #{roleId}
    </select>
    <!-- 根据角色id，菜单id，获取角色所拥有的菜单的操作权限 -->
    <select id="getSystemRoleElement" parameterType="java.util.Map">
        SELECT
            eleTable.action action,
          eleTable.name describe
        FROM
            (
                SELECT
                    elemt. ID ID,
                    elemt. METHOD action,
                    elemt. NAME name
                FROM
                    ADMIN_MENU menu,
                    ADMIN_ELEMENT elemt
                WHERE
                    menu. ID = elemt.MENU_ID
                AND menu. ID = #{menuId}
            ) eleTable
        LEFT JOIN ADMIN_RESOURCEROLEMAP resour ON eleTable. ID = RESOUR.RESOURCE_ID
        LEFT JOIN ADMIN_ROLE ROLE ON "ROLE". ID = RESOUR.ROLE_ID
        WHERE
            ROLE . ID = #{roleId}
    </select>
  

</mapper>